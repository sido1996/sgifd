<!-- ============================================================== -->
<!-- Start Page Content -->
<!-- ============================================================== -->
<div class="row">

    <div class="col-md-1 col-sm-12"></div>
    <div class="col-md-10 col-sm-12">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Commission Mixe Dsp</h4>
                <h6 class="card-subtitle">Détail d'une Commission Mixe Dsp.
                    <button class="btn btn-inverse btn-sm" [routerLink]="['../../list-commission-mixte-dsp']" style="float: right;">
            <i class="ti-menu"> </i> Liste des Commission Mixe Dsp
          </button>
                </h6>
                <hr>

                <div class="row">
                    <div class="col-md-12 col-sm-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="card-title">Données </h4>
                                <h6 class="card-subtitle">Information sur une Commission Mixe Dsp.
                                </h6>
                                <hr>

                                <div class="row">
                                    <div class="col-md-6 col-sm-12">
                                        <div *ngIf="commissionMixteDspSubmit != null">
                                            <span> Pays / Institutions PTFS : </span>
                                            <strong> {{ commissionMixteDspSubmit.institutionsPtf.denominationptf }} </strong>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-sm-12">
                                        <div *ngIf="commissionMixteDspSubmit != null">
                                            <span> Date Commission/Appprobation : </span>
                                            <strong> {{ commissionMixteDspSubmit.dateApprobation | date: 'dd-MM-yyyy' }} </strong>
                                        </div>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-6 col-sm-12">
                                        <div *ngIf="commissionMixteDspSubmit != null">
                                            <span> Date ou Année début Période : </span>
                                            <strong> {{ commissionMixteDspSubmit.dateOrAnneeDebutPeriode }} </strong>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-sm-12">
                                        <div *ngIf="commissionMixteDspSubmit != null">
                                            <span> Date ou Année fin Période : </span>
                                            <strong> {{ commissionMixteDspSubmit.dateOrAnneeFinPeriode }} </strong>
                                        </div>
                                    </div>
                                </div>
                                <br>

                                <div class="row">
                                    <div class="col-md-6 col-sm-12">
                                        <div *ngIf="commissionMixteDspSubmit != null">
                                            <span> Périodicité : </span>
                                            <strong> {{ commissionMixteDspSubmit.periodicite }} </strong>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-sm-12">
                                        <div *ngIf="commissionMixteDspSubmit != null">
                                            <span> Lieu de la dernière commission : </span>
                                            <strong> {{ commissionMixteDspSubmit.lieuDerniereCommission }} </strong>
                                        </div>
                                    </div>
                                </div>
                                <br>

                                <!--<div class="row">
                    <div class="col-md-6 col-sm-12">
                        <div *ngIf="commissionMixteDspSubmit != null">
                            <span> Référence(s) : </span>
                            <strong> {{ commissionMixteDspSubmit.libelle }} </strong>
                        </div>
                    </div>
                    <div class="col-md-6 col-sm-12">
                        <div *ngIf="commissionMixteDspSubmit != null">
                            <span> Domaines : </span>
                            <br>
                            <strong> {{ (commissionMixteDspSubmit.domaines != null)?
        '('+commissionMixteDspSubmit.domaines.length+')' : '#N/A' }} </strong>
                            <ul *ngIf="commissionMixteDspSubmit.domaines != null">
                                <li style="font-weight: bold;margin-bottom: 10px;" *ngFor="let domaine of
          commissionMixteDspSubmit.domaines">
                                    {{ domaine.libelle }}</li>
                            </ul>

                        </div>
                    </div>
                </div>
                <br>-->

                                <div class="row">
                                    <div class="col-md-6 col-sm-12">
                                        <div *ngIf="commissionMixteDspSubmit != null">
                                            <span> Sous-secteurs : </span>
                                            <strong>
                        {{ (commissionMixteDspSubmit.sousSecteurs != null)?
                        '('+commissionMixteDspSubmit.sousSecteurs.length+')' :
                        '#N/A' }} </strong>
                                            <ul *ngIf="commissionMixteDspSubmit.sousSecteurs != null">
                                                <li style="font-weight: bold;margin-bottom: 10px;" *ngFor="let sousSecteur of
                          commissionMixteDspSubmit.sousSecteurs">
                                                    {{ sousSecteur.secteur.libelle+' '+sousSecteur.libelle }}
                                                </li>
                                            </ul>
                                            <br>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-sm-12">
                                        <div *ngIf="commissionMixteDspSubmit != null">
                                            <span> ODD : </span>
                                            <strong>
                        {{ (commissionMixteDspSubmit.odd != null)?
                        '('+commissionMixteDspSubmit.odd.length+')' :
                        '#N/A' }} </strong>
                                            <ul *ngIf="commissionMixteDspSubmit.odd != null">
                                                <li style="font-weight: bold;margin-bottom: 10px;" *ngFor="let odds of
                          commissionMixteDspSubmit.odd"> {{ odds.libelle }}
                                                </li>
                                            </ul>
                                            <br>
                                        </div>
                                    </div>
                                </div>
                                <br>


                                <div class="row">
                                    <div class="col-md-4 col-sm-12">
                                        <div *ngIf="commissionMixteDspSubmit != null">
                                            <span> Montant en Devise : </span>
                                            <strong>
                        {{formatNumber(commissionMixteDspSubmit.montantPrevisionnelDevise) }}</strong>
                                        </div>
                                    </div>
                                    <div class="col-md-4 col-sm-12">
                                        <div *ngIf="commissionMixteDspSubmit != null">
                                            <span>Devise : </span>
                                            <strong> {{commissionMixteDspSubmit.deviseMonnaie.libelle
                        }}</strong>
                                        </div>

                                    </div>
                                    <div class="col-md-4 col-sm-12">
                                        <div *ngIf="commissionMixteDspSubmit != null">
                                            <span>Montant (F CFA) : </span>
                                            <strong>
                        {{formatNumber(commissionMixteDspSubmit.montantPrevisionnelFcfa) }}</strong>
                                        </div>
                                    </div>
                                </div>
                                <br>
                                <br>

                                <div class="row">
                                    <div class="col-md-6 col-sm-12">
                                        <div *ngIf="commissionMixteDspSubmit != null">
                                            <span> Obligations : </span>
                                            <br>
                                            <strong> {{ commissionMixteDspSubmit.obligations }}
                      </strong>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-sm-12">
                                        <div *ngIf="commissionMixteDspSubmit != null">
                                            <span> Recommandations : </span>
                                            <br>
                                            <strong> {{ commissionMixteDspSubmit.recommandation }}</strong>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="col-md-12 col-sm-12" style="margin-top: -1%;">
                        <br>
                        <div class="card" nzTitle="Axes de coopération">
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-striped border" style="width: 100%!important;">
                                        <thead>
                                            <tr>
                                                <th> Axes de coopération</th>
                                                <th> Montant Devise
                                                </th>
                                                <th> Devise</th>
                                                <th> Montant (F CFA)
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let axe of axePrioritaireCommissionsDspSubmit">
                                                <td> {{ axe.libelle }}
                                                </td>
                                                <td> {{ formatNumber(axe.montantPrevisionnelDevise) }}
                                                </td>
                                                <td> {{ axe.deviseMonnaie.libelle }}
                                                </td>
                                                <td> {{ formatNumber(axe.montantPrevisionnelFcfa) }}
                                                </td>


                                            </tr>
                                        </tbody>

                                    </table>

                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="col-md-12 col-sm-12" style="margin-top: -1%;">

                        <div class="card">
                            <div class="card-body">
                                <h4 class="card-title">Projets et programmes adressés</h4>
                                <h6 class="card-subtitle">Liste des projets et programmes adressés.</h6>
                                <hr>
                                <div class="table-responsive">

                                    <table class="table table-striped border" style="width: 100%!important;">
                                        <thead>
                                            <tr>
                                                <th> Référence(s)</th>
                                                <th> Désignation</th>
                                                <!-- <th> Secteur</th> -->
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let projet of projetIdeesSubmit">
                                                <td> {{ projet.reference }}</td>
                                                <td> {{ projet.libelle }}</td>
                                                <!-- <td> {{ projet.secteur.libelle }}
                                                </td> -->

                                            </tr>
                                        </tbody>

                                    </table>

                                </div>

                            </div>
                        </div>

                    </div>

                    <div class="col-md-12 col-sm-12" style="margin-top: -1%;">

                        <h4 class="card-title">Pièces jointes</h4>
                        <h6 class="card-subtitle">Liste des Pièces jointes.</h6>
                        <hr>
                        <div class="table-responsive">
                            <table class="table table-striped border">
                                <thead>
                                    <tr>
                                        <th> Date archivage</th>
                                        <th> Nom de la pièce</th>
                                        <th> Réf. Pièce</th>
                                        <th>
                                            <button type="button" class="btn btn-primary btn-circle btn-sm" style="float: right;" (click)="showModalPiece()"><i class="ti-plus"> </i></button>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngIf="filesRequete.length == 0">
                                        <td style="text-align: center;" colspan="4"> Aucune pièce</td>
                                    </tr>
                                    <tr *ngFor="let file of filesRequete let i=index">
                                        <td>
                                            {{ file.createdAt | date:'dd-MM-yyyy' }}
                                        </td>
                                        <td>
                                            {{ file.namePiece }}
                                        </td>
                                        <td>
                                            {{ file.refPiece }}
                                        </td>
                                        <td>
                                            <button type="button" class="btn btn-info btn-circle  btn-sm" style="float: right;" (click)="showModalPieceInfo(file)"><i class="ti-info"></i>
                    </button>
                                            <button type="button" class="btn btn-danger btn-circle btn-sm" style="float: right;" (click)="showMessageClosePiece(i,
                                file)"><i class="ti-close"></i>
                    </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>

                </div>
            </div>
        </div>
    </div>

</div>
<!-- ============================================================== -->
<!-- End PAge Content -->
<!-- ============================================================== -->
<!--gestion de gestion des pièces jointes-->
<nz-modal [(nzVisible)]="isVisibleFile" nzTitle="Formulaire d'ajoute de pièce " [nzCancelText]="'Fermer'" (nzOnCancel)="handleCancelReponse()" [nzClosable]="false" (nzOnOk)="submitFormFile()" [nzOkText]="'Enregistrer'">

    <form class="mt-4" [formGroup]="validateFormFile">
        <!-- Alert with rounded corner -->

        <nz-form-item>
            <nz-form-control>
                <h5> Nom de la pièce<span class="text-danger">*</span></h5>
                <input nz-input formControlName="namePiece" id="namePiece" class="form-control" oninput="this.value = this.value.toUpperCase()">
                <nz-form-explain *ngIf="validateFormFile.get('namePiece')?.dirty && validateFormFile.get('namePiece')?.errors">
                    Ce champs est obligatoire !
                </nz-form-explain>
            </nz-form-control>
        </nz-form-item>

        <nz-form-item>
            <nz-form-control>
                <h5> Réf. Pièce<span class="text-danger">*</span></h5>
                <input nz-input formControlName="refPiece" id="refPiece" class="form-control" oninput="this.value = this.value.toUpperCase()">
                <nz-form-explain *ngIf="validateFormFile.get('refPiece')?.dirty && validateFormFile.get('refPiece')?.errors">
                    Ce champs est obligatoire !
                </nz-form-explain>
            </nz-form-control>
        </nz-form-item>

        <nz-form-item>
            <nz-form-control>
                <h5> Réf. Emplacement physique</h5>
                <textarea rows="3" nz-input formControlName="refEmplacement" oninput="this.value = this.value.toUpperCase()"></textarea>

            </nz-form-control>
        </nz-form-item>

        <div class="form-group">
            <nz-form-item>
                <h5> Résumé du contenu </h5>
                <nz-form-control>
                    <textarea rows="3" nz-input formControlName="resumePiece"></textarea>

                </nz-form-control>
            </nz-form-item>
        </div>

        <div class="form-group">

            <input type="file" id="file" #fileInput (change)="handleFileInput($event)">
        </div>

        <!-- <div style="float: right;margin-bottom: -15px;">
      <button type="submit" class="btn btn-primary btn-sm" [disabled]="validateFormFile.invalid"
              style="margin-left: 10px;"><i class="ti-check"> </i> Enregistrer
      </button>
    </div>-->

    </form>

</nz-modal>


<!--information sur une pièce -->
<nz-modal [(nzVisible)]="isVisiblePieceInfo" nzTitle="Informations sur la pièce" [nzClosable]="false" (nzOnOk)="handleCancelPieceInfo()" [nzCancelText]="null" [nzOkText]="'OK'">

    <div *ngIf="pieceInfo != null">
        <p>
            <span> Nom de la pièce : </span> <strong> {{ pieceInfo.resumePiece != null ? pieceInfo.fileName : '#N/A'
      }} </strong>
        </p>
        <p>
            <span> Réf de la pièce : </span> <strong> {{ pieceInfo.resumePiece != null ? pieceInfo.refPiece : '#N/A'
      }} </strong>
        </p>
        <p>
            <span> Réf de l'emplacement physique : </span> <strong> {{ pieceInfo.resumePiece != null ?
      pieceInfo.refEmplacement : '#N/A' }} </strong>
        </p>
        <p>
            <span> Résumé du contenu : </span> <strong> {{ pieceInfo.resumePiece != null ? pieceInfo.resumePiece :
      '#N/A'}} </strong>
        </p>
        <p>
            <span> Date de sauvegarde de la pièce : </span> <strong> {{ pieceInfo.createdAt != null ? (pieceInfo.createdAt |
      date:'dd MM yyyy') : '#N/A'}} </strong>
        </p>
        <p>
            <button type="button" class="btn btn-primary btn-sm" (click)="downloadFile(pieceInfo.fullFileName)"><i class="ti-download"></i> cliquer ici pour télécharger la pièce
      </button>
        </p>
        <br>
    </div>

</nz-modal>