<!-- ============================================================== -->
<!-- Start Page Content -->
<!-- ============================================================== -->
<div class="row">
    <div class="col-md-1 col-sm-12"></div>
    <div class="col-md-10 col-sm-12">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">DETAIL</h4>
                <h6 class="card-subtitle">Détail de l'accord de coopération.

                    <button class="btn btn-inverse btn-sm" [routerLink]="['../../list-accord']" style="float: right;">
            <i class="ti-menu"> </i> Liste des accords
          </button>
                </h6>
                <hr>

                <div class="row">
                    <div class="col-md-12 col-sm-12">
                        <div class="card">

                            <div class="row">
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Catégorisation : </span> <strong style="margin-right: 20px;">
                                        {{ (accordSubmit != null)? accordSubmit.categorie :'#N/A'}} </strong>
                                    </p>
                                </div>
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Référence(s) : </span> <strong style="margin-right:20px;">
                                         {{ (accordSubmit != null)? accordSubmit.reference:'#N/A'}} </strong>
                                    </p>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Année: </span> <strong style="margin-right: 20px;">
                                         {{ (accordSubmit != null)? accordSubmit.annee.libelle :'#N/A'}} </strong>
                                    </p>
                                </div>
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Intitulé de l'accord: </span> <strong style="margin-right: 20px;">
                                        {{ (accordSubmit != null)? accordSubmit.intitule :'#N/A'}}
                                         </strong>
                                    </p>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Date de signature : </span> <strong style="margin-right: 20px;"> {{ (accordSubmit != null)?
                                         (accordSubmit.dateSignature | date:'dd-MM-yyyy') :'#N/A'}}
                                         </strong>
                                    </p>
                                </div>
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Durée de vie: </span> <strong style="margin-right:20px;">
                                      {{ (accordSubmit != null)? accordSubmit.dureeAccord :'#N/A'}} </strong>
                                    </p>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Date de ratification : </span> <strong style="margin-right: 20px;"> {{ (accordSubmit != null)? (accordSubmit.dateRatification | date:'dd-MM-yyyy'):'#N/A'}} </strong>
                                    </p>
                                </div>
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Date ratification ptf: </span> <strong style="margin-right: 20px;">
                                       {{ (accordSubmit != null)? (accordSubmit.dateDeMiseEnVigueurPtf | date:'dd-MM-yyyy') :'#N/A'}} </strong>
                                    </p>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Date Fin: </span> <strong style="margin-right: 20px;">
                                       {{ (accordSubmit != null)? (accordSubmit.dateFinAccord | date:'dd-MM-yyyy') :'#N/A'}} </strong>
                                    </p>
                                </div>
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Statut de l'accord: </span> <strong style="margin-right: 20px;">
                                       {{ (accordSubmit != null)? accordSubmit.statusAccord.libelle :'#N/A'}}
                                       </strong>
                                    </p>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Nom du signataire : </span> <strong style="margin-right: 20px;">
                                        {{ (accordSubmit != null)? accordSubmit.nomDuSignataire :'#N/A'}} </strong>
                                    </p>
                                </div>
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Lieu du signature : </span> <strong style="margin-right:20px;">
                                         {{ (accordSubmit != null)? accordSubmit.lieuDuSignature:'#N/A'}} </strong>
                                    </p>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Montant en Devise: </span> <strong style="margin-right: 20px;">
                                         {{ (accordSubmit != null)?formatNumber(accordSubmit.montantDevise) :'#N/A'}} </strong>
                                    </p>
                                </div>
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span>Devise : </span> <strong style="margin-right: 20px;">
                                        {{ (accordSubmit != null)?(accordSubmit.deviseMonnaie.libelle ) :'#N/A'}} </strong>
                                    </p>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Montant de l'accord (F CFA): </span> <strong style="margin-right: 20px;">
                                           {{ (accordSubmit != null)? formatNumber(accordSubmit.montant) :'#N/A'}} </strong>
                                    </p>
                                </div>
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Dépositaire de l'accord: </span> <strong style="margin-right: 20px;">
                                         {{ (accordSubmit != null)? accordSubmit.depositaire :'#N/A'}} </strong>
                                    </p>
                                </div>
                            </div>
                            <br>
                            <div class="row" *ngIf="selectedValue =='SANSPROJET'">
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Apport Partenaire en (Devise) : </span> <strong style="margin-right: 20px;">
                                        {{ (accordSubmit != null)? formatNumber(accordSubmit.apportPtfDevise) :'#N/A'}} </strong>
                                    </p>
                                </div>
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span>Devise : </span> <strong style="margin-right: 20px;">
                                        {{ (accordSubmit != null)? formatNumber(accordSubmit.deviseMonnaie.libelle ) :'#N/A'}} </strong>
                                    </p>
                                </div>
                            </div>
                            <br>
                            <div class="row" *ngIf="selectedValue =='SANSPROJET'">
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Apport Partenaire en (FCFA): </span> <strong style="margin-right: 20px;">
                                           {{ (accordSubmit != null)? formatNumber(accordSubmit.apportPtf) :'#N/A'}} </strong>
                                    </p>
                                </div>
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Contrepartie Béninoise (F CFA): </span> <strong style="margin-right: 20px;">
                                         {{ (accordSubmit != null)? formatNumber(accordSubmit.contrePartieNationale) :'#N/A'}} </strong>
                                    </p>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Avenants : </span> <strong style="margin-right: 20px;">
                                        {{ (accordSubmit != null)? accordSubmit.avenants :'#N/A'}} </strong>
                                    </p>
                                </div>
                                <div class="col-md-6 col-sm-6">
                                    <p>
                                        <span> Retombées/Analyse des contraintes : </span> <strong style="margin-right:20px;">
                                         {{ (accordSubmit != null)? accordSubmit.retombees:'#N/A'}} </strong>
                                    </p>
                                </div>
                            </div>

                            <!-- <div class="row">
  <div class="col-md-6 col-sm-6">
    <p>
      <span> Nature de financement : </span> <strong style="margin-right: 20px;">
      {{ (accordSubmit != null && accordSubmit.natureFinancement!=null)?
      accordSubmit.natureFinancement.libelle : '#N/A'}}
    </strong>
    </p>
  </div>
  <div class="col-md-6 col-sm-6">
    <p>
      <span> Nature Assistance : </span> <strong style="margin-right: 20px;">
      {{ (accordSubmit != null && accordSubmit.natureAssistance!=null)?
      accordSubmit.natureAssistance.libelle : '#N/A'}} </strong>
    </p>
  </div>
</div>
<div class="row">
  <div class="col-md-6 col-sm-6">
    <p>
      <span> Type accord : </span> <strong style="margin-right:
        20px;">
      {{ (accordSubmit != null && accordSubmit.typeAccord!=null)? accordSubmit.typeAccord.libelle
      : '#N/A'}} </strong>
    </p>
  </div>
  <div class="col-md-6 col-sm-6">

    <p>
      <span> Envergure: </span> <strong style="margin-right:
        20px;">
      {{ (accordSubmit != null && accordSubmit.envergure !=null)?
      accordSubmit.envergure.libelle : '#N/A'}} </strong>
    </p>
  </div>
</div>

<div class="row">
  <div class="col-md-6 col-sm-6">
                      <span> Liste des ODD : <strong>
        {{ (accordSubmit != null && accordSubmit.odds != null)?
        '('+accordSubmit.odds.length+')' : '#N/A' }} </strong>
    </span>
    <ul *ngIf="accordSubmit != null && accordSubmit.odds != null">
      <li style="font-weight: bold;" *ngFor="let odd of
        accordSubmit.odds"> {{ odd.libelle }}
      </li>
    </ul>
  </div>
  <div class="col-md-6 col-sm-6">

                      <span> Liste des Sous secteurs : <strong>
        {{ (accordSubmit != null && accordSubmit.sousSecteurs !=
        null)?
        '('+accordSubmit.sousSecteurs.length+')' : '#N/A' }}
      </strong> </span>
    <ul *ngIf="accordSubmit != null && accordSubmit.sousSecteurs
      != null">
      <li style="font-weight: bold;" *ngFor="let soussecteur of
        accordSubmit.sousSecteurs"> {{ soussecteur.libelle }}
      </li>
    </ul>
  </div>
</div>
<div class="row">
  <div class="col-md-6 col-sm-6">
                      <span> Liste des Piliers du PAG : <strong>
        {{ (accordSubmit != null && accordSubmit.pilierPAGs != null)?
        '('+accordSubmit.pilierPAGs.length+')' : '#N/A' }}
      </strong> </span>
    <ul *ngIf="accordSubmit != null && accordSubmit.pilierPAGs != null">
      <li style="font-weight: bold;" *ngFor="let pilier of
        accordSubmit.pilierPAGs"> {{ pilier.libelle }}
      </li>
    </ul>
  </div>
  <div class="col-md-6 col-sm-6">

    <p>
      <span> Intitulé: </span> <br><strong style="margin-right:
        20px;"> {{ (accordSubmit != null)?
      accordSubmit.intitule : '#N/A'}} </strong>
    </p>

  </div>
</div>
<div class="row">
  <div class="col-md-6 col-sm-6">
    <p>
      <span> Structures Bénéficiaire : </span> <strong style="margin-right: 20px;"> {{ (accordSubmit !=
      null && accordSubmit.structureBeneficiaire!=null)?
      accordSubmit.structureBeneficiaire.denominationStructure : '#N/A'}} </strong>
    </p>
  </div>
  <div class="col-md-6 col-sm-6">

                      <span> Partenaire Technique Financier (PTF) : <strong>
        {{ (accordSubmit != null && accordSubmit.ptfBailleurFrs != null)?
        '('+accordSubmit.ptfBailleurFrs.length+')' : '#N/A' }}
      </strong> </span>
    <ul *ngIf="accordSubmit != null && accordSubmit.ptfBailleurFrs != null">
      <li style="font-weight: bold;" *ngFor="let ptf of accordSubmit.ptfBailleurFrs"> {{
        ptf.denominationptf }}
      </li>
    </ul>
  </div>
</div> -->
                        </div>

                    </div>
                </div>

            </div>

            <div class="col-md-12 col-sm-12" *ngIf="selectedValue =='AVECPROJET'">

                <h4 class="card-title">Projets et programmes adressés</h4>
                <h6 class="card-subtitle">Liste des projets et programmes adressés.</h6>
                <hr>

                <div class="table-responsive">
                    <!-- Alert with rounded corner -->

                    <table class="table table-striped border" style="width:100%!important;">
                        <thead>
                            <tr>
                                <th>Référence(s)</th>
                                <th>Désignation</th>

                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let projet of projetIdeesSubmit">
                                <td> {{ projet.reference }}</td>
                                <td> {{ projet.libelle }}</td>
                            </tr>
                        </tbody>

                    </table>
                </div>
            </div>

            <br>
            <div class="col-md-12 col-sm-12">

                <h4 class="card-title">Pièces jointes</h4>
                <h6 class="card-subtitle">Liste des Pièces jointes.</h6>
                <hr>
                <div class="table-responsive">
                    <table class="table table-striped border">
                        <thead>
                            <tr>
                                <th> Date archivage</th>
                                <th> Nom de la pièce</th>
                                <th> Réf. Pièce</th>
                                <th>
                                    <button type="button" class="btn btn-primary btn-circle
                    btn-sm" style="float: right;" (click)="showModalPiece()"><i class="ti-plus"> </i></button>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngIf="filesRequete.length == 0">
                                <td style="text-align: center;" colspan="4"> Aucune pièce</td>
                            </tr>
                            <tr *ngFor="let file of filesRequete let i=index">
                                <td>
                                    {{ file.createdAt | date:'dd-MM-yyyy' }}
                                </td>
                                <td>
                                    {{ file.namePiece }}
                                </td>
                                <td>
                                    {{ file.refPiece }}
                                </td>
                                <td>
                                    <button type="button" class="btn btn-info btn-circle btn-sm" style="float: right;" (click)="showModalPieceInfo(file)"><i class="ti-info"></i>
                  </button>
                                    <button type="button" class="btn btn-danger btn-circle btn-sm" style="float: right;" (click)="showMessageClosePiece(i,
                    file)"><i class="ti-close"></i>
                  </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>


        </div>
    </div>

</div>
<!-- ============================================================== -->
<!-- End PAge Content -->
<!-- ============================================================== -->
<!--gestion de gestion des pièces jointes-->
<nz-modal [(nzVisible)]="isVisibleFile" nzTitle="Formulaire d'ajoute de pièce" [nzCancelText]="'Fermer'" (nzOnCancel)="handleCancelReponse()" [nzClosable]="false" (nzOnOk)="submitFormFile()" [nzOkText]="'Enregistrer'">

    <form class="mt-4" [formGroup]="validateFormFile">
        <!-- Alert with rounded corner -->

        <nz-form-item>
            <nz-form-control>
                <h5> Nom de la pièce<span class="text-danger">*</span></h5>
                <input nz-input formControlName="namePiece" id="namePiece" class="form-control" oninput="this.value= this.value.toUpperCase()">
                <nz-form-explain *ngIf="validateFormFile.get('namePiece')?.dirty &&
          validateFormFile.get('namePiece')?.errors">
                    Ce champs est obligatoire !
                </nz-form-explain>
            </nz-form-control>
        </nz-form-item>

        <nz-form-item>
            <nz-form-control>
                <h5> Réf. Pièce<span class="text-danger">*</span></h5>
                <input nz-input formControlName="refPiece" id="refPiece" class="form-control" oninput="this.value= this.value.toUpperCase()">
                <nz-form-explain *ngIf="validateFormFile.get('refPiece')?.dirty &&
          validateFormFile.get('refPiece')?.errors">
                    Ce champs est obligatoire !
                </nz-form-explain>
            </nz-form-control>
        </nz-form-item>

        <nz-form-item>
            <nz-form-control>
                <h5> Réf. Emplacement physique</h5>
                <textarea rows="3" nz-input formControlName="refEmplacement" oninput="this.value= this.value.toUpperCase()"></textarea>
            </nz-form-control>
        </nz-form-item>

        <div class="form-group">
            <nz-form-item>
                <h5> Résumé du contenu </h5>
                <nz-form-control>
                    <textarea rows="3" nz-input formControlName="resumePiece"></textarea>
                </nz-form-control>
            </nz-form-item>
        </div>

        <div class="form-group">

            <input type="file" id="file" #fileInput (change)="handleFileInput($event)">
        </div>

        <!-- <div style="float: right;margin-bottom: -15px;">
<button type="submit" class="btn btn-primary btn-sm" [disabled]="validateFormFile.invalid"
      style="margin-left: 10px;"><i class="ti-check"> </i> Enregistrer
</button>
</div>-->

    </form>

</nz-modal>

<!--information sur une pièce -->
<nz-modal [(nzVisible)]="isVisiblePieceInfo" nzTitle="Informations sur la pièce" [nzClosable]="false" (nzOnOk)="handleCancelPieceInfo()" [nzCancelText]="null" [nzOkText]="'OK'">
    <div *ngIf="pieceInfo != null">
        <p>
            <span> Nom de la pièce : </span> <strong> {{ pieceInfo.resumePiece != null
        ? pieceInfo.fileName : '#N/A'
        }} </strong>
        </p>
        <p>
            <span> Réf de la pièce : </span> <strong> {{ pieceInfo.resumePiece != null
        ? pieceInfo.refPiece : '#N/A'
        }} </strong>
        </p>
        <p>
            <span> Réf de l'emplacement physique : </span> <strong> {{
        pieceInfo.resumePiece != null ?
        pieceInfo.refEmplacement : '#N/A' }} </strong>
        </p>
        <p>
            <span> Résumé du contenu : </span> <strong> {{ pieceInfo.resumePiece !=
        null ? pieceInfo.resumePiece :
        '#N/A'}} </strong>
        </p>
        <p>
            <span> Date de sauvegarde de la pièce : </span> <strong> {{
        pieceInfo.createdAt != null ? (pieceInfo.createdAt |
        date:'dd MM yyyy') : '#N/A'}} </strong>
        </p>
        <p>
            <button type="button" class="btn btn-primary btn-sm" (click)="downloadFile(pieceInfo.fullFileName)"><i
          class="ti-download"></i> cliquer ici pour télécharger la pièce
      </button>
        </p>
        <br>
    </div>

</nz-modal>